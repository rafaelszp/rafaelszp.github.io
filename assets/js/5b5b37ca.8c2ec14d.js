"use strict";(self.webpackChunkrafaelszp_github_io=self.webpackChunkrafaelszp_github_io||[]).push([[6329],{1073:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>t,contentTitle:()=>i,default:()=>m,frontMatter:()=>n,metadata:()=>d,toc:()=>l});var o=s(4848),r=s(8453);const n={sidebar_label:"AWS Lambda - Vis\xe3o geral"},i="AWS Lambda - Vis\xe3o geral",d={id:"aws/Computing/Articles/AWS Lambda - Vis\xe3o geral",title:"AWS Lambda - Vis\xe3o geral",description:"Created04",source:"@site/docs/aws/Computing/Articles/AWS Lambda - Vis\xe3o geral.md",sourceDirName:"aws/Computing/Articles",slug:"/aws/Computing/Articles/AWS Lambda - Vis\xe3o geral",permalink:"/docs/aws/Computing/Articles/AWS Lambda - Vis\xe3o geral",draft:!1,unlisted:!1,editUrl:"https://github.com/rafaelszp/rafaelszp.github.io/tree/main/packages/create-docusaurus/templates/shared/docs/aws/Computing/Articles/AWS Lambda - Vis\xe3o geral.md",tags:[],version:"current",frontMatter:{sidebar_label:"AWS Lambda - Vis\xe3o geral"},sidebar:"principal",previous:{title:"Intro",permalink:"/docs/aws/"},next:{title:"ECS Fargate Container Deployment",permalink:"/docs/aws/Computing/Articles/ECS Fargate Deployment"}},t={},l=[{value:"O que \xe9?",id:"o-que-\xe9",level:2},{value:"Como funciona?",id:"como-funciona",level:2},{value:"Detalhes internos",id:"detalhes-internos",level:2},{value:"Uso de microcont\xeaineres",id:"uso-de-microcont\xeaineres",level:3},{value:"IAM",id:"iam",level:3},{value:"Autenticidade do c\xf3digo",id:"autenticidade-do-c\xf3digo",level:3},{value:"M\xfaltiplas vers\xf5es em paralelo",id:"m\xfaltiplas-vers\xf5es-em-paralelo",level:2},{value:"Uso de VPC",id:"uso-de-vpc",level:2},{value:"Vari\xe1veis de ambiente",id:"vari\xe1veis-de-ambiente",level:2},{value:"Modos de invoca\xe7\xe3o",id:"modos-de-invoca\xe7\xe3o",level:2},{value:"Sincronicidade",id:"sincronicidade",level:3},{value:"Meios de invoca\xe7\xe3o",id:"meios-de-invoca\xe7\xe3o",level:3},{value:"Controlando falhas de fun\xe7\xf5es ass\xedncronas",id:"controlando-falhas-de-fun\xe7\xf5es-ass\xedncronas",level:3},{value:"Plataformas e arquiteturas suportadas",id:"plataformas-e-arquiteturas-suportadas",level:2},{value:"Garantindo capacidades e diminuindo o cold start",id:"garantindo-capacidades-e-diminuindo-o-cold-start",level:2},{value:"Cold Start na plataforma Java",id:"cold-start-na-plataforma-java",level:3},{value:"Uso de Layers para depend\xeancias",id:"uso-de-layers-para-depend\xeancias",level:2},{value:"Uso de storage externo",id:"uso-de-storage-externo",level:2},{value:"Limites",id:"limites",level:2},{value:"Monitoramento",id:"monitoramento",level:2},{value:"Custo",id:"custo",level:2},{value:"Pontos a observar e pr\xe1ticas recomendadas",id:"pontos-a-observar-e-pr\xe1ticas-recomendadas",level:2},{value:"Considera\xe7\xf5es pessoais sobre o uso",id:"considera\xe7\xf5es-pessoais-sobre-o-uso",level:2},{value:"Refer\xeancias",id:"refer\xeancias",level:2}];function c(e){const a={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.h1,{id:"aws-lambda---vis\xe3o-geral",children:"AWS Lambda - Vis\xe3o geral"}),"\n",(0,o.jsx)(a.p,{children:"Created: 2024-05-29 07:04"}),"\n",(0,o.jsxs)(a.p,{children:["Tags: ",(0,o.jsx)(a.code,{children:"#aws"})," ",(0,o.jsx)(a.code,{children:"#servless"})," ",(0,o.jsx)(a.code,{children:"#lambda"})]}),"\n",(0,o.jsx)(a.h2,{id:"o-que-\xe9",children:"O que \xe9?"}),"\n",(0,o.jsxs)(a.p,{children:["Segundo a documenta\xe7\xe3o da fabricante ",(0,o.jsx)(a.em,{children:'"O AWS Lambda \xe9 um servi\xe7o de computa\xe7\xe3o que permite executar c\xf3digo sem o provisionamento ou gerenciamento de servidores."'}),' Basicamente, o intuito desta Cloud Provider \xe9 fornecer um servi\xe7o que reduz as "preocupa\xe7\xf5es" dos clientes somente com o c\xf3digo da rotina que desejam executar, pois o provisionamento de infraestrutura, servidores, configura\xe7\xf5es e toda a parafern\xe1lia necess\xe1ria fica abstra\xedda para "longe das vistas" do cliente.']}),"\n",(0,o.jsx)(a.p,{children:'\xc9 importante ressaltar que mesmo que seja categorizado como servless, n\xe3o significa que n\xe3o h\xe1 servidores e infraestrutura por traz deste servi\xe7o. O que esse termo "servless" traz consigo \xe9 o conceito de "foque no que precisa fazer", a estrutura necess\xe1ria fica cargo da AWS.'}),"\n",(0,o.jsx)(a.h2,{id:"como-funciona",children:"Como funciona?"}),"\n",(0,o.jsx)(a.p,{children:"O servi\xe7o \xe9 executado em microcont\xeaineres, assim a cada requisi\xe7\xe3o ou evento para uma determinada fun\xe7\xe3o Lambda, \xe9 iniciado o microcont\xeainer correspondente que ir\xe1 responder por aquela requisi\xe7\xe3o. Estes microcont\xeaineres s\xe3o reaproveitados desde que n\xe3o estejam desalocados e estejam ociosos."}),"\n",(0,o.jsxs)(a.p,{children:["Quando um microcont\xeainer \xe9 iniciado pela primeira vez e inicializado ele passa por um processo chamado ",(0,o.jsx)(a.strong,{children:"Cold Start"})," que \xe9 basicamente condensado nos seguintes passos:"]}),"\n",(0,o.jsx)(a.p,{children:(0,o.jsx)(a.img,{alt:"100%",src:s(2532).A+"",width:"712",height:"180"})}),"\n",(0,o.jsx)(a.p,{children:"Um importante aspecto a considerar que o Cold Start precisa de um tempo para ser conclu\xeddo, isto significa que as primeiras requisi\xe7\xf5es levar\xe3o mais tempo para concluir. Para termos uma id\xe9ia, devido ao processo de inicializa\xe7\xe3o, as 5% requisi\xe7\xf5es mais lentas do Lambda s\xe3o mais lentas que o servi\xe7o AWS Fargate."}),"\n",(0,o.jsx)(a.h2,{id:"detalhes-internos",children:"Detalhes internos"}),"\n",(0,o.jsx)(a.h3,{id:"uso-de-microcont\xeaineres",children:"Uso de microcont\xeaineres"}),"\n",(0,o.jsxs)(a.p,{children:["Os micront\xeaineres executam somente uma fun\xe7\xe3o por vez, para que suporte mais requisi\xe7\xf5es, mais ambientes devem ser criados para que haja paralelismo, isto significa que haver\xe1 ",(0,o.jsx)(a.strong,{children:"Cold start"})," para cada cont\xeainer que respons\xe1vel por responder \xe0s requisi\xe7\xf5es."]}),"\n",(0,o.jsxs)(a.p,{children:["Basicamente, as fun\xe7\xf5es s\xe3o executadas a partir do c\xf3digo escrito na fun\xe7\xe3o ",(0,o.jsx)(a.code,{children:"handler"}),", sendo poss\xedvel utilizar o ",(0,o.jsx)(a.strong,{children:"global scope"}),", desta forma outras execu\xe7\xf5es do mesmo microcont\xeainer podem se aproveitar das vari\xe1veis, constantes e fun\xe7\xf5es que l\xe1 forem declaradas. Ainda sobre o ",(0,o.jsx)(a.strong,{children:"global scope"}),", \xe9 importante ressaltar que ele utiliza muitos recursos de CPU e mem\xf3ria, al\xe9m disto os primeiros 10s de execu\xe7\xe3o neste escopo n\xe3o s\xe3o cobrados."]}),"\n",(0,o.jsx)(a.h3,{id:"iam",children:"IAM"}),"\n",(0,o.jsxs)(a.p,{children:["Durante a execu\xe7\xe3o, as fun\xe7\xf5es as lambda functions utilizam uma Execution Role para acessarem servi\xe7os servi\xe7os e recursos da AWS, como por exemplo enviar trace data para o AWS X-Ray. Desta forma as fun\xe7\xf5es Lambda ir\xe3o ",(0,o.jsx)(a.strong,{children:"assumir"})," este role, de modo que n\xe3o \xe9 preciso chamar o ",(0,o.jsx)(a.code,{children:"sts:AssumeRole"})," manualmente dentro da fun\xe7\xe3o, pois a AWS faz isso automaticamente."]}),"\n",(0,o.jsx)(a.h3,{id:"autenticidade-do-c\xf3digo",children:"Autenticidade do c\xf3digo"}),"\n",(0,o.jsxs)(a.p,{children:["No quesito seguran\xe7a da informa\xe7\xe3o, \xe9 poss\xedvel utilizar o servi\xe7o AWS Signer para garantir a autenticidade do c\xf3digo mediante uso de um ",(0,o.jsx)(a.em,{children:"Signing profile"})," apropriado. Basicamente s\xe3o utilizados 2 buckets S3, sendo um para armazenar os objetos que ser\xe3o assinados e outro bucket para guardar os objetos assinados, assim o AWS Signer utilizar\xe1 um ",(0,o.jsx)(a.em,{children:"signing job"})," para capturar os objetos n\xe3o assinados, assin\xe1-los e guardar no bucket apropriado."]}),"\n",(0,o.jsx)(a.h2,{id:"m\xfaltiplas-vers\xf5es-em-paralelo",children:"M\xfaltiplas vers\xf5es em paralelo"}),"\n",(0,o.jsx)(a.p,{children:"Uma funcionalidade importante das Lambda Functions \xe9 que \xe9 poss\xedvel manter v\xe1rias vers\xf5es da mesma fun\xe7\xe3o sendo executadas em paralelo, de modo que podemos manter a compatibilidade com aplica\xe7\xf5es que utilizam vers\xf5es mais antigas das fun\xe7\xf5es."}),"\n",(0,o.jsx)(a.p,{children:"Para utilizar esta estrat\xe9gia, podemos referenciar as fun\xe7\xf5es das seguintes formas:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:"Pelo ARN da fun\xe7\xe3o, que mant\xeam nos \xfaltimos blocos a refer\xeancia da revis\xe3o utilizada"}),"\n",(0,o.jsx)(a.li,{children:"Por meio de aliases/apelidos da fun\xe7\xe3o, deixando revis\xe3o com car\xe1ter mais mnem\xf4nico."}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"uso-de-vpc",children:"Uso de VPC"}),"\n",(0,o.jsx)(a.p,{children:"Existem servi\xe7os que residem dentro de uma VPC e s\xf3 podem ser acessados por recursos que estiverem alocados nela, por isso, caso seja necess\xe1rio comunicar com algum destes desses servi\xe7os atrav\xe9s de fun\xe7\xf5es Lambda, devemos associ\xe1-las \xe0s VPCs ondem residem esses recursos."}),"\n",(0,o.jsx)(a.p,{children:"Associar as fun\xe7\xf5es \xe0 VPC implica maiores custos, por exemplo:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:"Haver\xe1 custo de transfer\xeancia de dados entre as lambdas e os servi\xe7os acessados;"}),"\n",(0,o.jsx)(a.li,{children:"Haver\xe1 custo de storage;"}),"\n",(0,o.jsx)(a.li,{children:"Haver\xe1 maior custo referente ao ColdStart;"}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"vari\xe1veis-de-ambiente",children:"Vari\xe1veis de ambiente"}),"\n",(0,o.jsx)(a.p,{children:"As fun\xe7\xf5es Lambda utilizam vari\xe1veis de ambiente durante sua execu\xe7\xe3o, de modo que dentro do c\xf3digo da fun\xe7\xe3o \xe9 poss\xedvel executar as rotinas padr\xe3o da runtime escolhida para ler os valores das vari\xe1veis de ambiente, por exemplo:"}),"\n",(0,o.jsxs)(a.table,{children:[(0,o.jsx)(a.thead,{children:(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.th,{children:"Runtime"}),(0,o.jsx)(a.th,{children:"Rotina"})]})}),(0,o.jsxs)(a.tbody,{children:[(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"Java"}),(0,o.jsx)(a.td,{children:(0,o.jsx)(a.code,{children:"System.getenv()"})})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"Python"}),(0,o.jsx)(a.td,{children:(0,o.jsx)(a.code,{children:"os.environ"})})]}),(0,o.jsxs)(a.tr,{children:[(0,o.jsx)(a.td,{children:"NodeJS"}),(0,o.jsx)(a.td,{children:(0,o.jsx)(a.code,{children:"process.env"})})]})]})]}),"\n",(0,o.jsxs)(a.p,{children:["Durante a execu\xe7\xe3o das fun\xe7\xf5es lambda, s\xe3o injetadas vari\xe1veis padr\xe3o da AWS, como: ",(0,o.jsx)(a.code,{children:"AWS_REGION"}),", ",(0,o.jsx)(a.code,{children:"X_AMZN_TRACE_ID"})," e ",(0,o.jsx)(a.code,{children:"AWS_LAMBDA_FUNCION_VERSION"})]}),"\n",(0,o.jsx)(a.h2,{id:"modos-de-invoca\xe7\xe3o",children:"Modos de invoca\xe7\xe3o"}),"\n",(0,o.jsx)(a.h3,{id:"sincronicidade",children:"Sincronicidade"}),"\n",(0,o.jsx)(a.p,{children:"As fun\xe7\xf5es Lambda podem ser invocadas das seguintes formas:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.code,{children:"InvocationType: Event"}),", ou seja, de modo ass\xedncrono. Isto significa que retornam imediatamente uma resposta, bem ao estilo ",(0,o.jsx)(a.em,{children:"Fire and Forget"})]}),"\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.code,{children:"InvocationType: RequestResponse"}),", ou seja s\xedncrono, no modelo RPC, em que esperada umas resposta ap\xf3s o t\xe9rmino do processamento."]}),"\n"]}),"\n",(0,o.jsx)(a.h3,{id:"meios-de-invoca\xe7\xe3o",children:"Meios de invoca\xe7\xe3o"}),"\n",(0,o.jsx)(a.p,{children:"\xc9 poss\xedvel realizar a invoca\xe7\xe3o de fun\xe7\xf5es lambda por v\xe1rios meios a saber:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:"EventBrige, atrav\xe9s de regra de agendamento peri\xf3dico"}),"\n",(0,o.jsx)(a.li,{children:"API Gateway"}),"\n",(0,o.jsx)(a.li,{children:"Outras fun\xe7\xf5es lambda via AWS SDK"}),"\n",(0,o.jsx)(a.li,{children:"Aplica\xe7\xf5es, via AWS SDK"}),"\n",(0,o.jsx)(a.li,{children:"Chamadas de API"}),"\n",(0,o.jsx)(a.li,{children:"AWS CLI"}),"\n",(0,o.jsx)(a.li,{children:"SQS Queue"}),"\n"]}),"\n",(0,o.jsx)(a.h3,{id:"controlando-falhas-de-fun\xe7\xf5es-ass\xedncronas",children:"Controlando falhas de fun\xe7\xf5es ass\xedncronas"}),"\n",(0,o.jsx)(a.p,{children:"Caso uma invoca\xe7\xe3o ass\xedncrona de fun\xe7\xe3o falhe ou que expire sem que haja processamento, \xe9 poss\xedvel realizar as seguintes a\xe7\xf5es:"}),"\n",(0,o.jsxs)(a.ol,{children:["\n",(0,o.jsx)(a.li,{children:"Utilizar o mecanismo padr\xe3o de on-failure destination (SNS Queue, SNS Topic, EventBridge, outra fun\xe7\xe3o Lambda)"}),"\n",(0,o.jsx)(a.li,{children:"Configurar uma Dead-letter-queue (DLQ) para registrar esses eventos e ter um maior controle como gerenciar as falhas, levando em conta que as SQS Queues tem tempo de vida, mesmo as DLQs."}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"plataformas-e-arquiteturas-suportadas",children:"Plataformas e arquiteturas suportadas"}),"\n",(0,o.jsx)(a.p,{children:"Nativamente as fun\xe7\xf5es AWS Lambda suportam as seguintes plataformas de desenvolvimento (at\xe9 a presente data):"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:"NodeJS, 20, 18, 16"}),"\n",(0,o.jsx)(a.li,{children:"Python: 3.8-12"}),"\n",(0,o.jsx)(a.li,{children:"Java: 21,17,11,8"}),"\n",(0,o.jsx)(a.li,{children:".Net: 6-8"}),"\n",(0,o.jsx)(a.li,{children:"Ruby: 3.2 e 3.3"}),"\n"]}),"\n",(0,o.jsx)(a.p,{children:"Caso seja preciso utilizar outras plataformas de progra\xe7\xe3o, como Rust ou Go, \xe9 necess\xe1rio providenciar uma runtime para executar as fun\xe7\xf5es Lambda, em formato de arquivo zip."}),"\n",(0,o.jsx)(a.p,{children:"Em rela\xe7\xe3o \xe0s arquiteturas suportadas, at\xe9 o presente momento, temos:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:"x86_64, baseada em processadores x86"}),"\n",(0,o.jsx)(a.li,{children:"arm64, baseada no processador AWS Graviton2"}),"\n"]}),"\n",(0,o.jsx)(a.p,{children:"Tamb\xe9m \xe9 poss\xedvel provisionar runtimes de outras plataformas de programa\xe7\xe3o em formato de imagens Docker."}),"\n",(0,o.jsx)(a.h2,{id:"garantindo-capacidades-e-diminuindo-o-cold-start",children:"Garantindo capacidades e diminuindo o cold start"}),"\n",(0,o.jsx)(a.p,{children:"Para diminuir o impacto do cold start, referente ao tempo de resposta aumentado em consequ\xeancia do bootstrap da fun\xe7\xe3o, podemos utilizar as seguintes estrat\xe9gias:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:["Utilizar o ",(0,o.jsx)(a.strong,{children:"Reserved Concurrency"}),", em que indica o n\xfamero m\xe1ximo de execu\xe7\xf5es paralelas para uma fun\xe7\xe3o espec\xedfica. A defini\xe7\xe3o deste par\xe2metro consome o limite de fun\xe7\xf5es em execu\xe7\xe3o por regi\xe3o;"]}),"\n",(0,o.jsxs)(a.li,{children:["Utilizar o ",(0,o.jsx)(a.strong,{children:"provisioned concurrency"}),", que s\xe3o inst\xe2ncias pr\xe9-inicializadas e j\xe1 prontas para responder as requisi\xe7\xf5es rapidamente."]}),"\n",(0,o.jsx)(a.li,{children:'Realizar, periodicamente, health checks estrat\xe9gicos por meio de EventBridge Scheduling rules, desta forma teremos "quase sempre" inst\xe2ncias ativas, levando em conta que em algum momento, mesmo com esta estrat\xe9gia, as inst\xe2ncias ser\xe3o desprovisionadas automaticamente pela AWS'}),"\n"]}),"\n",(0,o.jsx)(a.h3,{id:"cold-start-na-plataforma-java",children:"Cold Start na plataforma Java"}),"\n",(0,o.jsxs)(a.p,{children:["O cold start na plataforma Java \xe9 consideravelmente maior do que nas plataformas baseadas em script como NodeJs e Python. Por isso, ao considerar esta plataforma devemos considerar o uso do ",(0,o.jsx)(a.strong,{children:"SnapStart"})," para melhorar o tempo de inicializa\xe7\xe3o em at\xe9 10x, al\xe9m disto, o uso de provisioned concurrency tamb\xe9m deve ser considerado."]}),"\n",(0,o.jsx)(a.p,{children:'Para que o tempo de cold start seja diminu\xeddo, o SnapStart "tira" um snapshot da mem\xf3ria e do estado do disco, aprimorando o tempo de boot em at\xe9 10 vezes.'}),"\n",(0,o.jsx)(a.h2,{id:"uso-de-layers-para-depend\xeancias",children:"Uso de Layers para depend\xeancias"}),"\n",(0,o.jsx)(a.p,{children:"Para um uso mais efetivo das lambda functions, diminuindo os tempos de packaging e de cold start, \xe9 importante utilizar Layers para armazenar as depend\xeancias da aplica\xe7\xe3o. S\xe3o basicamente arquivos zip que s\xe3o carregados na configura\xe7\xe3o das lambda functions."}),"\n",(0,o.jsxs)(a.p,{children:["\xc9 importante frisar que os pacotes de depend\xeancias devem estar nas pastas corretas, por exemplo o NodeJS precisa que o ",(0,o.jsx)(a.code,{children:"node_modules"})," esteja na pasta ",(0,o.jsx)(a.code,{children:"nodejs"}),", localizada na raiz do projeto."]}),"\n",(0,o.jsx)(a.h2,{id:"uso-de-storage-externo",children:"Uso de storage externo"}),"\n",(0,o.jsx)(a.p,{children:"\xc9 poss\xedvel utilizar servi\xe7os de storage da AWS nas modalidades EFS e S3. Sendo que para o EFS, devemos considerar:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:"Haver\xe1 custo de tr\xe1fego entre o lambda e o EFS"}),"\n",(0,o.jsx)(a.li,{children:"\xc9 preciso associar uma lambda \xe0 VPC, pois o EFS \xe9 regional"}),"\n",(0,o.jsx)(a.li,{children:"Haver\xe1 custo de throughput"}),"\n",(0,o.jsx)(a.li,{children:"Haver\xe1 custo de armazenamento no EFS"}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"limites",children:"Limites"}),"\n",(0,o.jsx)(a.p,{children:"Existem limites nas Lambda Functions que devem ser observados:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:"Tamanho m\xe1ximo de uma fun\xe7\xe3o, contemplando Layers e projeto: 50mb para arquivos zipados e 250mb decompactado;"}),"\n",(0,o.jsx)(a.li,{children:"Tempo m\xe1ximo de execu\xe7\xe3o de uma fun\xe7\xe3o: 15min. Este limite n\xe3o \xe9 ajust\xe1vel"}),"\n",(0,o.jsx)(a.li,{children:"Limite de fun\xe7\xf5es operando concorrentemente: 1000 para contas antigas"}),"\n",(0,o.jsx)(a.li,{children:"Storage para fun\xe7\xf5es: 75GB por regi\xe3o"}),"\n",(0,o.jsx)(a.li,{children:"Uma fun\xe7\xe3o pode usar entre 128mb e 10204mb de RAM. Este limite n\xe3o \xe9 ajust\xe1vel"}),"\n",(0,o.jsx)(a.li,{children:"Uma fun\xe7\xe3o pode ter, no m\xe1ximo 5 layers. Este limite n\xe3o \xe9 ajust\xe1vel"}),"\n",(0,o.jsx)(a.li,{children:"Payload m\xe1ximo ass\xedncrono: 256Kb"}),"\n",(0,o.jsx)(a.li,{children:"Payload m\xe1ximo s\xedncrono: 6mb"}),"\n"]}),"\n",(0,o.jsxs)(a.p,{children:["Os limites acima s\xe3o os mais relevantes, por\xe9m \xe9 recomend\xe1vel observar todos os limites na ",(0,o.jsx)(a.a,{href:"https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-limits.html",children:"documenta\xe7\xe3o oficial"}),"."]}),"\n",(0,o.jsx)(a.h2,{id:"monitoramento",children:"Monitoramento"}),"\n",(0,o.jsx)(a.p,{children:"O monitoramento das execu\xe7\xf5es das fun\xe7\xf5es lambda pode ser realizado pelo AWS Cloudwatch de forma que podemos monitorar as seguintes m\xe9tricas:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.strong,{children:"Invocations"}),", numero de invoca\xe7\xf5es"]}),"\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.strong,{children:"Duration"}),", tempo de processamento (avg, min, max)"]}),"\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.strong,{children:"Error count"})," e ",(0,o.jsx)(a.strong,{children:"success rate(%)"})]}),"\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.strong,{children:"Throttles"})," - N\xfamero de falhas devido a problemas de limites de concorr\xeancia"]}),"\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.strong,{children:"IteratorAge"}),", para stream event sources, a idade do \xfaltimo item no batch quando o Lambda o recebeu e invocou a fun\xe7\xe3o"]}),"\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.strong,{children:"Async delivery failure"}),"s, n\xfamero de erros ao tentar gravar no destino ou na DLQ"]}),"\n",(0,o.jsxs)(a.li,{children:[(0,o.jsx)(a.strong,{children:"Concurrent executions"}),", numero de inst\xe2ncias que est\xe3o processando eventos"]}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"custo",children:"Custo"}),"\n",(0,o.jsx)(a.p,{children:"A cobran\xe7a das fun\xe7\xf5es lambda \xe9 baseada nos seguintes par\xe2metros:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:"Mem\xf3ria configurada"}),"\n",(0,o.jsx)(a.li,{children:"Tempo de execu\xe7\xe3o"}),"\n",(0,o.jsx)(a.li,{children:"Uso de storage tempor\xe1rio (ephemeral storage)"}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"pontos-a-observar-e-pr\xe1ticas-recomendadas",children:"Pontos a observar e pr\xe1ticas recomendadas"}),"\n",(0,o.jsx)(a.p,{children:"Sobre o uso de lambda h\xe1 alguns pontos que devemos nos atentar como:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:"Ao usar DLQs, atente-se para o TTL dos eventos l\xe1 registrados para eventos importantes n\xe3o sejam perdidos"}),"\n",(0,o.jsxs)(a.li,{children:["Os primeiros 10s de processamento do ",(0,o.jsx)(a.em,{children:"global scope"})," n\xe3o \xe9 cobrado, ent\xe3o \xe9 boa pr\xe1tica utiliz\xe1-lo para diminuir custos de opera\xe7\xe3o"]}),"\n",(0,o.jsx)(a.li,{children:"Regularmente, invoque health-checks estrat\xe9gicos, para diminuir o impacto dos cold starts"}),"\n",(0,o.jsx)(a.li,{children:"Mesmo com health-checks estrat\xe9gicos, as inst\xe2ncias s\xe3o desprovisionadas automaticamente pela AWS"}),"\n",(0,o.jsxs)(a.li,{children:["Caso seja imperativo manter um tempo de resposta baixo, utilize a estrat\xe9gia de ",(0,o.jsx)(a.strong,{children:"preserved concurrency"})]}),"\n",(0,o.jsx)(a.li,{children:"O uso e preserved concurrency acarreta:"}),"\n",(0,o.jsx)(a.li,{children:"Maior tempo de deployment"}),"\n",(0,o.jsx)(a.li,{children:"Maior custo"}),"\n",(0,o.jsx)(a.li,{children:"Quanto maior a mem\xf3ria definida para a fun\xe7\xe3o lambda, maior ser\xe1 o custo financeiro atrelado ao aumento de recursos de de processamento e de mem\xf3ria"}),"\n",(0,o.jsx)(a.li,{children:"Sempre considere o tempo m\xe1ximo de execu\xe7\xe3o de uma fun\xe7\xe3o, que \xe9 de 15 minutos e n\xe3o \xe9 ajust\xe1vel"}),"\n",(0,o.jsx)(a.li,{children:"Fun\xe7\xf5es ass\xedncronas n\xe3o tem retorno imediato de falha, \xe9 preciso utilizar os mecanismos apropriados para monitorar os erros"}),"\n",(0,o.jsxs)(a.li,{children:["Para invocar outras fun\xe7\xf5es lambda a permiss\xe3o ",(0,o.jsx)(a.code,{children:"lambda:InvokeFuncion"})," \xe9 requerida na execution role da fun\xe7\xe3o"]}),"\n",(0,o.jsx)(a.li,{children:"Atente-se para o timeout correto esperado da fun\xe7\xe3o, ajustando o valor apropriado para n\xe3o incorrer em erros de timeout"}),"\n",(0,o.jsx)(a.li,{children:"\xc9 poss\xedvel publicar uma fun\xe7\xe3o direto na Internet, sem uso de um API Gateway, por meio de uma URL de acesso"}),"\n",(0,o.jsxs)(a.li,{children:["O acesso direto pela Internet deve vir junto com a configura\xe7\xe3o de ",(0,o.jsx)(a.em,{children:"Authentication type"})," para ",(0,o.jsx)(a.code,{children:"node"}),", para que o IAM n\xe3o negue o acesso"]}),"\n",(0,o.jsx)(a.li,{children:"Caso precisemos dimunir a lat\xeancia \xe9 poss\xedvel utilizar o servi\xe7o Lambda@Edge integrado ao CloudFront"}),"\n",(0,o.jsx)(a.li,{children:"O Lambda@Edge n\xe3o possui todas as funcionalidades, ent\xe3o \xe9 preciso arquitetar bem o uso desta caracter\xedstica"}),"\n",(0,o.jsx)(a.li,{children:"Existe prote\xe7\xe3o de recurs\xe3o, para evitar loops infinitos e consequentemente custos n\xe3o esperados. Este recurso \xe9 parametriz\xe1vel e habilitado por padr\xe3o, sendo que o limite padr\xe3o de recurs\xe3o \xe9 16, suportando outros servi\xe7os como SQS e SNS"}),"\n",(0,o.jsx)(a.li,{children:"Caso n\xe3o haja nenhum microcont\xeainer ocioso, ocorrer\xe1 cold start de novas inst\xe2ncias, aumentando o tempo da requisi\xe7\xe3o"}),"\n",(0,o.jsxs)(a.li,{children:["At\xe9 o presente momento o SnapStart ",(0,o.jsx)(a.strong,{children:"N\xe3o est\xe1"})," dispon\xedvel para arm64"]}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"considera\xe7\xf5es-pessoais-sobre-o-uso",children:"Considera\xe7\xf5es pessoais sobre o uso"}),"\n",(0,o.jsx)(a.p,{children:"Basicamente, Lambda deve ser utilizada para processamentos r\xe1pidos, de baixo tthroughput, baixo grau de paralelismo e nenhum acoplamento. Acredito que os melhores usos s\xe3o para:"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:"Transforma\xe7\xf5es r\xe1pidas"}),"\n",(0,o.jsx)(a.li,{children:"encaminhamento de processamento"}),"\n",(0,o.jsx)(a.li,{children:'encarregado de "saber" para quem entregar (orquestrador)'}),"\n",(0,o.jsx)(a.li,{children:"Descarregar DLQs"}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"refer\xeancias",children:"Refer\xeancias"}),"\n",(0,o.jsxs)(a.ol,{children:["\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"https://docs.aws.amazon.com/pt_br/lambda/latest/dg/welcome.html",children:"https://docs.aws.amazon.com/pt_br/lambda/latest/dg/welcome.html"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"https://docs.aws.amazon.com/lambda/latest/dg/runtimes-custom.html",children:"https://docs.aws.amazon.com/lambda/latest/dg/runtimes-custom.html"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"https://docs.aws.amazon.com/pt_br/lambda/latest/dg/images-create.html",children:"https://docs.aws.amazon.com/pt_br/lambda/latest/dg/images-create.html"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"https://docs.aws.amazon.com/lambda/latest/dg/snapstart.html",children:"https://docs.aws.amazon.com/lambda/latest/dg/snapstart.html"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"https://docs.aws.amazon.com/lambda/latest/dg/lambda-intro-execution-role.html",children:"https://docs.aws.amazon.com/lambda/latest/dg/lambda-intro-execution-role.html"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-run-lambda-schedule.html",children:"https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-run-lambda-schedule.html"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"https://docs.aws.amazon.com/lambda/latest/dg/services-apigateway.html",children:"https://docs.aws.amazon.com/lambda/latest/dg/services-apigateway.html"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"https://docs.aws.amazon.com/lambda/latest/dg/example_lambda_Invoke_section.html",children:"https://docs.aws.amazon.com/lambda/latest/dg/example_lambda_Invoke_section.html"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"https://docs.aws.amazon.com/lambda/latest/dg/with-sqs.html",children:"https://docs.aws.amazon.com/lambda/latest/dg/with-sqs.html"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"https://aws.amazon.com/blogs/compute/implementing-aws-lambda-error-handling-patterns/",children:"https://aws.amazon.com/blogs/compute/implementing-aws-lambda-error-handling-patterns/"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"https://docs.aws.amazon.com/signer/latest/developerguide/lambda-workflow.html",children:"https://docs.aws.amazon.com/signer/latest/developerguide/lambda-workflow.html"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"https://docs.aws.amazon.com/lambda/latest/dg/lambda-concurrency.html",children:"https://docs.aws.amazon.com/lambda/latest/dg/lambda-concurrency.html"})}),"\n",(0,o.jsx)(a.li,{children:(0,o.jsx)(a.a,{href:"https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-limits.html",children:"https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-limits.html"})}),"\n"]})]})}function m(e={}){const{wrapper:a}={...(0,r.R)(),...e.components};return a?(0,o.jsx)(a,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},2532:(e,a,s)=>{s.d(a,{A:()=>o});const o=s.p+"assets/images/AWS Lambda Coldstart.excalidraw-e125b62f14b5dcb9eb0af31bc605d3bc.svg"},8453:(e,a,s)=>{s.d(a,{R:()=>i,x:()=>d});var o=s(6540);const r={},n=o.createContext(r);function i(e){const a=o.useContext(n);return o.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function d(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(n.Provider,{value:a},e.children)}}}]);