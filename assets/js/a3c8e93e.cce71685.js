"use strict";(self.webpackChunkrafaelszp_github_io=self.webpackChunkrafaelszp_github_io||[]).push([[876],{8541:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>p,frontMatter:()=>s,metadata:()=>c,toc:()=>l});var i=r(4848),a=r(8453);const s={title:"OpenSSL - useful commands",date:"2020-07-13",categories:["linux"]},t=void 0,c={permalink:"/blog/2020/07/13/2020/07/openssl-useful-commands",editUrl:"https://github.com/rafaelszp/rafaelszp.github.io/tree/master/blog/blog/2020/07/2020-07-13-openssl-useful-commands/index.md",source:"@site/blog/2020/07/2020-07-13-openssl-useful-commands/index.md",title:"OpenSSL - useful commands",description:"Disclaimer",date:"2020-07-13T00:00:00.000Z",tags:[],readingTime:2.615,hasTruncateMarker:!1,authors:[],frontMatter:{title:"OpenSSL - useful commands",date:"2020-07-13",categories:["linux"]},unlisted:!1,prevItem:{title:"Forcing new SameSite and Secure values into nginx reverse proxied resource",permalink:"/blog/2020/07/28/2020/07/forcing-new-samesite-and-secure-values-into-nginx-reverse-proxied-resource"},nextItem:{title:"Checking certificate validity with openssl command",permalink:"/blog/2020/07/10/2020/07/checking-certificate-validity-with-openssl-command"}},o={authorsImageUrls:[]},l=[{value:"Certificate requests and key generation",id:"certificate-requests-and-key-generation",level:2},{value:"Generate a new certificate request using an existing private key:",id:"generate-a-new-certificate-request-using-an-existing-private-key",level:5},{value:"Generate a certificate request starting from an existing certificate:",id:"generate-a-certificate-request-starting-from-an-existing-certificate",level:5},{value:"Generate a new RSA private key:",id:"generate-a-new-rsa-private-key",level:5},{value:"Encrypt a private key with a passphrase:",id:"encrypt-a-private-key-with-a-passphrase",level:5},{value:"Remove a passphrase from an encrypted private key:",id:"remove-a-passphrase-from-an-encrypted-private-key",level:5},{value:"Generate a new ECC private key:",id:"generate-a-new-ecc-private-key",level:5},{value:"Create a self-signed certificate",id:"create-a-self-signed-certificate",level:2},{value:"View and verify certificates",id:"view-and-verify-certificates",level:2},{value:"Check and display a certificate request (CSR):",id:"check-and-display-a-certificate-request-csr",level:5},{value:"Verify and display a key pair:",id:"verify-and-display-a-key-pair",level:5},{value:"View a PEM-encoded certificate:",id:"view-a-pem-encoded-certificate",level:5},{value:"View a certificate encoded in PKCS#7 format:",id:"view-a-certificate-encoded-in-pkcs7-format",level:5},{value:"View a certificate and key pair encoded in PKCS#12 format:",id:"view-a-certificate-and-key-pair-encoded-in-pkcs12-format",level:5},{value:"Verify an SSL connection and display all certificates in the chain:",id:"verify-an-ssl-connection-and-display-all-certificates-in-the-chain",level:5},{value:"Control whether a certificate, a certificate request and a private key have the same public key:",id:"control-whether-a-certificate-a-certificate-request-and-a-private-key-have-the-same-public-key",level:5},{value:"Check a certificate and its intermediate certificate chain for web server purposes:",id:"check-a-certificate-and-its-intermediate-certificate-chain-for-web-server-purposes",level:5},{value:"Certificate conversion",id:"certificate-conversion",level:2},{value:"Conversion of PKCS#12 ( .pfx .p12, typically used on Microsoft Windows) files with private key and certificate to PEM (typically used on Linux):",id:"conversion-of-pkcs12--pfx-p12-typically-used-on-microsoft-windows-files-with-private-key-and-certificate-to-pem-typically-used-on-linux",level:5},{value:"Conversion of PEM to PKCS#12:",id:"conversion-of-pem-to-pkcs12",level:5},{value:"Conversion of PKCS#7 format ( .p7b .p7c ) to PEM:",id:"conversion-of-pkcs7-format--p7b-p7c--to-pem",level:5},{value:"Conversion of PEM format to PKCS#7:",id:"conversion-of-pem-format-to-pkcs7",level:5},{value:"Conversion of DER (.crt .cer or .der) to PEM:",id:"conversion-of-der-crt-cer-or-der-to-pem",level:5},{value:"Conversion from PEM to DER format:",id:"conversion-from-pem-to-der-format",level:5},{value:"Checking SSL Connections",id:"checking-ssl-connections",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h5:"h5",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Disclaimer"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["This is only for my reference purpose. Don't use this article. If you want a realiable source consider reading the original post here ",(0,i.jsx)(n.a,{href:"https://www.kinamo.be/en/support/faq/useful-openssl-commands",children:"https://www.kinamo.be/en/support/faq/useful-openssl-commands"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"certificate-requests-and-key-generation",children:"Certificate requests and key generation"}),"\n",(0,i.jsx)(n.p,{children:"Typically, when you ordered a new SSL certificate you must generate a CSR or certificate signing request, with a new private key:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl req -sha256 -nodes -newkey rsa:2048 -keyout www.server.com.key -out www.server.com.csr\n"})}),"\n",(0,i.jsx)(n.h5,{id:"generate-a-new-certificate-request-using-an-existing-private-key",children:"Generate a new certificate request using an existing private key:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl req -new -sha256 -key www.server.com.key -out www.server.com.csr\n"})}),"\n",(0,i.jsx)(n.h5,{id:"generate-a-certificate-request-starting-from-an-existing-certificate",children:"Generate a certificate request starting from an existing certificate:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl x509 -x509toreq -in www.server.com.crt -out www.server.com.csr -signkey www.server.com.key\n"})}),"\n",(0,i.jsx)(n.h5,{id:"generate-a-new-rsa-private-key",children:"Generate a new RSA private key:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl genrsa -out www.server.com.key 2048\n"})}),"\n",(0,i.jsx)(n.h5,{id:"encrypt-a-private-key-with-a-passphrase",children:"Encrypt a private key with a passphrase:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl rsa -in www.server.com.key -out www.server.com.key -des3\n"})}),"\n",(0,i.jsx)(n.h5,{id:"remove-a-passphrase-from-an-encrypted-private-key",children:"Remove a passphrase from an encrypted private key:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl rsa -in www.server.com.key -out www.server.com.key\n"})}),"\n",(0,i.jsx)(n.h5,{id:"generate-a-new-ecc-private-key",children:"Generate a new ECC private key:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl ecparam -out server.key -name prime256v1 -genkey\n"})}),"\n",(0,i.jsx)(n.h2,{id:"create-a-self-signed-certificate",children:"Create a self-signed certificate"}),"\n",(0,i.jsx)(n.p,{children:"Generate a self-signed certificate for testing purposes with one year validity period, together with a new 2048-bit key:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl req -x509 -newkey rsa:2048 -nodes -keyout www.server.com.key -out www.server.com.crt -days 365\n"})}),"\n",(0,i.jsx)(n.h2,{id:"view-and-verify-certificates",children:"View and verify certificates"}),"\n",(0,i.jsx)(n.h5,{id:"check-and-display-a-certificate-request-csr",children:"Check and display a certificate request (CSR):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl req -noout -text -verify -in www.server.com.csr\n"})}),"\n",(0,i.jsx)(n.h5,{id:"verify-and-display-a-key-pair",children:"Verify and display a key pair:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl rsa -noout -text -check -in www.server.com.key\n"})}),"\n",(0,i.jsx)(n.h5,{id:"view-a-pem-encoded-certificate",children:"View a PEM-encoded certificate:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl x509 -noout -text -in www.server.com.crt\n"})}),"\n",(0,i.jsx)(n.h5,{id:"view-a-certificate-encoded-in-pkcs7-format",children:"View a certificate encoded in PKCS#7 format:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl pkcs7 -print_certs -in www.server.com.p7b\n"})}),"\n",(0,i.jsx)(n.h5,{id:"view-a-certificate-and-key-pair-encoded-in-pkcs12-format",children:"View a certificate and key pair encoded in PKCS#12 format:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl pkcs12 -info -in www.server.com.pfx\n"})}),"\n",(0,i.jsx)(n.h5,{id:"verify-an-ssl-connection-and-display-all-certificates-in-the-chain",children:"Verify an SSL connection and display all certificates in the chain:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl s_client -connect www.server.com:443\n"})}),"\n",(0,i.jsx)(n.h5,{id:"control-whether-a-certificate-a-certificate-request-and-a-private-key-have-the-same-public-key",children:"Control whether a certificate, a certificate request and a private key have the same public key:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl x509 -noout -modulus www.server.com.crt | openssl sha256\nopenssl req -noout -modulus www.server.com.csr | openssl sha256\nopenssl rsa -noout -modulus www.server.com.key | openssl sha256\n"})}),"\n",(0,i.jsx)(n.h5,{id:"check-a-certificate-and-its-intermediate-certificate-chain-for-web-server-purposes",children:"Check a certificate and its intermediate certificate chain for web server purposes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl verify -purpose sslserver -CAfile certificatebundle.pem -verbose www.server.com.crt\n"})}),"\n",(0,i.jsx)(n.h2,{id:"certificate-conversion",children:"Certificate conversion"}),"\n",(0,i.jsx)(n.h5,{id:"conversion-of-pkcs12--pfx-p12-typically-used-on-microsoft-windows-files-with-private-key-and-certificate-to-pem-typically-used-on-linux",children:"Conversion of PKCS#12 ( .pfx .p12, typically used on Microsoft Windows) files with private key and certificate to PEM (typically used on Linux):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl pkcs12 -nodes -in www.server.com.pfx -out www.server.com.crt\n"})}),"\n",(0,i.jsx)(n.h5,{id:"conversion-of-pem-to-pkcs12",children:"Conversion of PEM to PKCS#12:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl pkcs12 -export -in www.server.com.crt -inkey www.server.com.key -out www.server.com.pfx\n"})}),"\n",(0,i.jsx)(n.h5,{id:"conversion-of-pkcs7-format--p7b-p7c--to-pem",children:"Conversion of PKCS#7 format ( .p7b .p7c ) to PEM:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl pkcs7 -print_certs -in www.server.com.p7b -out www.server.com.crt  \n"})}),"\n",(0,i.jsx)(n.h5,{id:"conversion-of-pem-format-to-pkcs7",children:"Conversion of PEM format to PKCS#7:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl crl2pkcs7 -nocrl -certfile www.server.com.crt -out www.server.com.p7b\n"})}),"\n",(0,i.jsx)(n.h5,{id:"conversion-of-der-crt-cer-or-der-to-pem",children:"Conversion of DER (.crt .cer or .der) to PEM:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl x509 -inform der -in certificate.cer -out certificate.pem\n"})}),"\n",(0,i.jsx)(n.h5,{id:"conversion-from-pem-to-der-format",children:"Conversion from PEM to DER format:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl x509 -outform der -in certificate.pem -out certificate.cer\n"})}),"\n",(0,i.jsx)(n.h2,{id:"checking-ssl-connections",children:"Checking SSL Connections"}),"\n",(0,i.jsx)(n.p,{children:"This will output the website's certificate, including any intermediate certificates"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"openssl s_client -connect https://www.server.com:443\n"})})]})}function p(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>c});var i=r(6540);const a={},s=i.createContext(a);function t(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);